---
title: "高性能MySQL"
date: 2021-08-10T18:12:52+08:00
draft: true
---

### MySQL事务隔离性
- Read uncommitted（未提交读）
    > 脏读、不可重复读、幻读
- Read committed（已提交读）
    > 不可重复读、幻读
- Repeatable read（可重复读）
    > 幻读
- Serializable（可串行化）
- 悲观锁
- 乐观锁（MVVC 多版本并存）

### 选择优化的数据类型
> 简单原则

- 更小通常更好
- 简单就好，整型比字符串操作代价低
    - MySQL内建类型存储日期和时间，而不是字符串
    - 整型存储IP地址
- 尽量避免NULL

### 高性能的索引策略

独立的列：不能是表达式的一部分，不能是函数的参数

前缀索引：列的部分数据作为索引
索引选择性：不重复的索引值和总记录数的比值
前缀索引结合索引选择性的值来确定前缀长度

聚簇索引优点：
- 相关数据同区域化
- 数据访问更快，索引和数据保存在同一个B-Tree
- 覆盖索引扫描的查询直接使用叶节点中的主键值
聚簇索引缺点：
- 提高I/O密集型的性能。如果内存存放数据，访问顺序就不那么重要
- 插入速度严重依赖插入顺序
- 更新聚簇索引列的代价很高
- 页分裂
- 全表扫描，行比较稀疏
- 二级索引数据更大
- 二级索引访问需要两次索引查找（自适应哈希索引会减少这样重复的工作）

顺序主键的问题：1.间隙锁竞争 2.AUTO_INCREMENT锁机制

### 多版本并发控制 (MVCC)

### 间隙锁 (next-key locking)

### 聚簇索引 二级索引（非主键索引）

